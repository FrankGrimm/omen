{% extends "layout.html" %}
{% block body %}
  <h1>Datasets </h1>

  <div class="row">
      <div class="col-12">
          <a class="btn btn-light" style="font-size: 12pt" href="{{ url_for('new_dataset') }}" title="Create new dataset">
        create new <i class="fas fa-plus-circle"></i>
      </a>
      </div>
  </div>

  <h4>My Datasets</h4>
    
  <div class="row">
  
      <ul class="dslist col-12 list-group">
    {% for dsid, ds in my_datasets.items() %}
        <li class="ds_meta list-group-item">
            <div class="row">
                <div class="col-sm-4 col-md-3 col-lg-3">
                    <div class="btn-group">
                    <a class="btn btn-sm btn-light" href="{{ url_for("new_dataset", dsid=dsid) }}" title="Edit Dataset"><i class="fas fa-cog"></i></a> 

                    {% if not (ds and ds_errors and ds in ds_errors and ds_errors[ds]) %}
                    <a class="btn btn-sm btn-secondary" href="{{ url_for("download", dsid=dsid) }}" title="Download"><i class="fas fa-download"></i></a> 
                    <a class="btn btn-sm btn-secondary" href="{{ url_for("inspect_dataset", dsid=dsid) }}" title="View"><i class="fas fa-table"></i></a> 
                    {% endif %}
                    </div>
                </div>
                <div class="col-sm col-md col-lg ds_overview_label">
                <a href="{{ url_for('new_dataset', dsid=dsid) }}" title="Edit Dataset">
                    {{ ds.get_name() }}
                </a>
                </div>
            </div>
            {% if ds and ds_errors and ds in ds_errors and ds_errors[ds] %}
            <div class="row">
                <ul class="ds_overview_issues offset-2 col-10">
                    {% for errmsg in ds_errors[ds] %}
                    <li class="badge badge-warning">{{ errmsg }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </li>
    {% endfor %}
      </ul>
  
  </div>

  <h4>Shared Datasets</h4>

  <div class="row">
      <ul class="dslist col-12 list-group">
    {% for dsid, ds in access_datasets.items() %}
        {% set dsroles = ds.get_roles(dbsession, userobj) %}
        <li class="ds_meta list-group-item">
            <div class="row">
            <div class="col-sm-4 col-md-3 col-lg-3">
                <div class="btn-group">
                    {% if 'curator' in dsroles %}
                    <a class="btn btn-sm btn-secondary" href="{{ url_for("download", dsid=dsid) }}" title="Download"><i class="fas fa-download"></i></a> 
                    {% endif %}
                    {% if 'annotator' in dsroles %}
                    <a class="btn btn-sm btn-secondary" href="{{ url_for("inspect_dataset", dsid=dsid) }}" title="View"><i class="fas fa-table"></i></a> 
                    {% endif %}
                </div>
            </div>
            <div class="col-sm col-md col-lg ds_overview_label">
                <i class="fas fa-users"></i> <strong>{{ ds.get_name() }}</strong>, owned by {{ ds.owner.get_name() }} (access: {{ dsroles|join(", ") }})
            </div>
            </div>
        </li>
    {% endfor %}
      </ul>
      
    </div>
{% endblock %}
